---
layout: post
title: "[Security] 메일 격리 해제"
author: sion
categories: [ Administration, ExchangeOnline, Security]
description: "78"
image: assets/images/thumbnail/etc.png
---

본 포스팅에서는 격리된 메일을 릴리즈하는 방법에 대해 소개합니다.  


### 메일 격리

테넌트를 운영하다보면, 메일이 사서함에 수신되지 않았다는 문의를 종종 받게 됩니다.  

이는 "Microsoft Defender for Office 365"에서 제공하는 메일 보안을 위한 여러 기능들에 의한 것인데요,  
해당 기능들을 통틀어서 [EOP(Exchange Online Protection)][1] 라고 부릅니다.  

<img src="{{site.baseurl}}/assets/images/78/1.png" title="EOP">

EOP에는 다양한 기능들이 포함되어 있고, 위 사진과 같이 여러 정책을 거치며 비정상 메일은 "정크 메일(Junk Mail)" 폴더로 가거나 사용자에게 발송되지 않고 EOP 단에서 격리됩니다.  


### 격리된 메일 릴리즈

EOP의 각 기능에 대해서는 추후 포스팅을 통해 다뤄보기로 하고,  
본 포스팅에서는 격리된 메일을 릴리즈 하는 방법에 소개하도록 합니다.  

<img src="{{site.baseurl}}/assets/images/78/2.png" title="격리된 메일 릴리즈1">

[[Microsoft Defender 관리센터][2]] > [전자 메일 및 공동 작업] > [검토] > [격리] 를 클릭합니다.  

<img src="{{site.baseurl}}/assets/images/78/3.png" title="격리된 메일 릴리즈2">

화면에서 격리된 메일들의 리스트를 볼 수 있습니다.  

<img src="{{site.baseurl}}/assets/images/78/4.png" title="격리된 메일 릴리즈3">

필터링을 통해 원하는 조건의 격리된 메일들만 추려서 조회하는 것도 가능합니다.  

<img src="{{site.baseurl}}/assets/images/78/5.png" title="격리된 메일 릴리즈4">

메일을 선택하면 상세 내용을 확인할 수 있으며, [해제] 버튼을 클릭하면 릴리즈가 가능합니다.  
다만 관리센터 내에서는 한 번에 100개의 항목씩만 릴리즈가 가능합니다.  

다량의 메일을 손쉽게 릴리즈하기 위해서는, 아래 Powershell 명령어를 이용한 일괄 처리가 가능합니다.  

```
Connect-ExchangeOnline
Get-QuarantineMessage -SenderAddress spam@domain.com -ReleaseStatus NotReleased -StartReceivedDate '2025-08-27' -PageSize 1000 | Release-QuarantineMessage -ReleasetoAll
```

[Get-QuarantineMessage][3] 는 옵션에 만족하는 격리된 메일들을 조회하는 명령어이고,  
[Release-QuarantineMessage][4] 는 해당하는 메일들을 릴리즈하는 명령어입니다.  

Get-QuarantineMessage에서 조회 가능한 데이터 사이즈는 Page, PageSize 옵션을 통해 지정이 가능하며  
해당 데이터보다 많은 격리 메일들을 일괄적으로 릴리즈가 필요한 경우 for 문을 통해 명령어를 여러번 실행해주는 방식으로도 수행이 가능하겠습니다 🙂


[1]: https://learn.microsoft.com/en-us/defender-office-365/eop-about
[2]: https://security.microsoft.com
[3]: https://learn.microsoft.com/en-us/powershell/module/exchangepowershell/get-quarantinemessage?view=exchange-ps
[4]: https://learn.microsoft.com/en-us/powershell/module/exchangepowershell/release-quarantinemessage?view=exchange-ps